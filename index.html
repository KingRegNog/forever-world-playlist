const playlistId = "PLr2GfQUli3msPDzdWGNt7FVKk-5GPmeAL";
const feedUrl = `https://forever-world-rss.your-subdomain.workers.dev?playlist=${playlistId}`;

fetch(feedUrl)
  .then(res => res.text())
  .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
  .then(data => {
    const container = document.getElementById("playlist");
    const entries = data.getElementsByTagName("entry");

    for (let entry of entries) {
      const videoIdEl = entry.getElementsByTagNameNS("*", "videoId")[0];
      const titleEl = entry.getElementsByTagName("title")[0];

      if (!videoIdEl || !titleEl) continue; // skip if missing

      const id = videoIdEl.textContent;
      const title = titleEl.textContent;

      const card = document.createElement("a");
      card.className = "video";
      card.href = `https://youtu.be/${id}`;
      card.target = "_blank";

      card.innerHTML = `
        <div class="thumb">
          <img src="https://img.youtube.com/vi/${id}/hqdefault.jpg" alt="${title}">
          <div class="play">â–¶</div>
        </div>
        <div class="title">${title}</div>
      `;

      container.appendChild(card);
    }
  })
  .catch(err => {
    console.error("Playlist failed to load:", err);
    document.getElementById("playlist").innerHTML =
      "<p style='color: #FFD700;'>Failed to load playlist. Try again later.</p>";
  });
